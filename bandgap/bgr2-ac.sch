v {xschem version=3.4.7 file_version=1.2}
G {}
K {}
V {}
S {}
E {}
L 4 560 -530 560 -80 {}
L 4 560 -80 670 -80 {}
L 4 560 -530 670 -530 {}
L 4 670 -530 670 -80 {}
L 4 170 -530 170 -80 {}
L 4 170 -530 520 -530 {}
L 4 520 -530 520 -80 {}
L 4 170 -80 520 -80 {}
L 4 700 -530 700 -80 {}
L 4 700 -530 1050 -530 {}
L 4 700 -80 1050 -80 {}
L 4 1050 -530 1050 -80 {}
L 4 540 -880 540 -740 {}
L 4 540 -880 820 -880 {}
L 4 540 -740 820 -740 {}
L 4 820 -880 820 -740 {}
P 4 1 1020 -820 {}
T {BGR CORE} 290 -580 0 0 0.4 0.4 {}
T {CURVATURE
CORRECTION} 550 -600 0 0 0.4 0.4 {}
T {STARTUP 
CIRCUIT} 830 -600 0 0 0.4 0.4 {}
T {RC Lowpass Filter} 590 -920 0 0 0.4 0.4 {}
N 240 -500 460 -500 {lab=VDD}
N 400 -470 420 -470 {lab=#net1}
N 350 -470 350 -410 {lab=#net1}
N 240 -440 240 -290 {lab=#net2}
N 240 -500 240 -470 {lab=VDD}
N 460 -500 460 -470 {lab=VDD}
N 280 -170 310 -170 {lab=VSS}
N 310 -170 310 -120 {lab=VSS}
N 240 -140 240 -120 {lab=VSS}
N 390 -120 460 -120 {lab=VSS}
N 460 -140 460 -120 {lab=VSS}
N 390 -170 420 -170 {lab=VSS}
N 390 -170 390 -120 {lab=VSS}
N 240 -220 240 -200 {lab=VBE1}
N 240 -290 240 -280 {lab=#net2}
N 370 -290 460 -290 {lab=#net3}
N 240 -290 330 -290 {lab=#net2}
N 400 -330 410 -330 {lab=VDD}
N 290 -330 300 -330 {lab=VSS}
N 1400 -510 1400 -500 {lab=GND}
N 150 -500 240 -500 {lab=VDD}
N 150 -120 240 -120 {lab=VSS}
N 460 -280 460 -200 {lab=#net3}
N 550 -470 580 -470 {lab=#net1}
N 470 -480 480 -470 {lab=#net1}
N 410 -480 470 -480 {lab=#net1}
N 400 -470 410 -480 {lab=#net1}
N 460 -500 620 -500 {lab=VDD}
N 620 -300 620 -120 {lab=VSS}
N 460 -120 620 -120 {lab=VSS}
N 550 -470 550 -400 {lab=#net1}
N 550 -400 750 -400 {lab=#net1}
N 750 -400 750 -360 {lab=#net1}
N 720 -330 750 -330 {lab=VSS}
N 720 -330 720 -120 {lab=VSS}
N 750 -300 750 -120 {lab=VSS}
N 720 -120 750 -120 {lab=VSS}
N 460 -280 800 -280 {lab=#net3}
N 800 -280 800 -230 {lab=#net3}
N 840 -200 840 -120 {lab=VSS}
N 750 -120 840 -120 {lab=VSS}
N 620 -500 620 -470 {lab=VDD}
N 840 -500 840 -470 {lab=VDD}
N 620 -500 840 -500 {lab=VDD}
N 790 -330 840 -330 {lab=#net4}
N 840 -330 840 -260 {lab=#net4}
N 950 -470 980 -470 {lab=VSS}
N 960 -500 1020 -500 {lab=VDD}
N 910 -500 910 -390 {lab=VDD}
N 950 -120 1020 -120 {lab=VSS}
N 840 -230 860 -230 {lab=VSS}
N 860 -230 860 -120 {lab=VSS}
N 950 -430 950 -420 {lab=VSS}
N 950 -390 960 -390 {lab=VDD}
N 960 -500 960 -390 {lab=VDD}
N 950 -430 1020 -430 {lab=VSS}
N 1020 -500 1020 -470 {lab=VDD}
N 280 -470 350 -470 {lab=#net1}
N 240 -120 310 -120 {lab=VSS}
N 310 -120 390 -120 {lab=VSS}
N 350 -470 400 -470 {lab=#net1}
N 480 -470 550 -470 {lab=#net1}
N 620 -120 720 -120 {lab=VSS}
N 460 -290 460 -280 {lab=#net3}
N 840 -440 840 -330 {lab=#net4}
N 840 -500 910 -500 {lab=VDD}
N 840 -120 860 -120 {lab=VSS}
N 880 -470 950 -470 {lab=VSS}
N 910 -500 960 -500 {lab=VDD}
N 950 -470 950 -430 {lab=VSS}
N 1020 -440 1020 -430 {lab=VSS}
N 860 -120 950 -120 {lab=VSS}
N 620 -440 620 -430 {lab=#net5}
N 620 -370 620 -360 {lab=#net5}
N 460 -310 460 -290 {lab=#net3}
N 460 -440 460 -430 {lab=OUT}
N 460 -430 460 -370 {lab=OUT}
N 620 -430 620 -370 {lab=#net5}
N 510 -830 580 -830 {lab=OUT}
N 580 -830 620 -830 {lab=OUT}
N 510 -830 510 -640 {lab=OUT}
N 460 -410 490 -410 {lab=OUT}
N 510 -640 510 -410 {lab=OUT}
N 490 -410 510 -410 {lab=OUT}
N 950 -260 950 -120 {lab=VSS}
N 950 -360 950 -320 {lab=VSS}
N 1020 -430 1020 -320 {lab=VSS}
N 1020 -260 1020 -120 {lab=VSS}
N 950 -320 950 -260 {lab=VSS}
N 1020 -320 1020 -260 {lab=VSS}
C {afe-icdec-teknofest-2026/bandgap/bgr-opamp/bgr-opamp.sym} 190 -130 1 1 {name=x1}
C {sky130_fd_pr/pfet_01v8.sym} 440 -470 0 0 {name=M1
W=20
L=5
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 260 -470 0 1 {name=M2
W=20
L=5
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {res.sym} 460 -340 0 0 {name=R1
value=980k
footprint=1206
device=resistor
m=1}
C {res.sym} 240 -250 0 0 {name=R2
value=200.3k
footprint=1206
device=resistor
m=1}
C {sky130_fd_pr/pnp_05v5.sym} 440 -170 0 0 {name=Q1
model=pnp_05v5_W3p40L3p40
m=1
spiceprefix=X
}
C {sky130_fd_pr/pnp_05v5.sym} 260 -170 0 1 {name=Q2
model=pnp_05v5_W3p40L3p40
m=64
spiceprefix=X
}
C {lab_pin.sym} 410 -330 0 1 {name=p1 sig_type=std_logic lab=VDD}
C {lab_pin.sym} 290 -330 0 0 {name=p2 sig_type=std_logic lab=VSS}
C {vsource.sym} 1180 -540 0 0 {name=V1 value="DC 1.8 AC 1m" savecurrent=false}
C {vsource.sym} 1400 -540 0 0 {name=V2 value="DC 0" savecurrent=false}
C {lab_pin.sym} 1180 -510 0 0 {name=p7 sig_type=std_logic lab=VSS}
C {lab_pin.sym} 1400 -570 0 0 {name=p8 sig_type=std_logic lab=VSS}
C {gnd.sym} 1400 -500 0 0 {name=l1 lab=GND}
C {lab_pin.sym} 1180 -570 0 0 {name=p9 sig_type=std_logic lab=VDD}
C {sky130_fd_pr/corner.sym} 1130 -390 0 0 {name=CORNER only_toplevel=true corner=tt}
C {code_shown.sym} 1280 -420 0 0 {name=s1 only_toplevel=false value="

.control
 ac dec 200 1 1e9
 plot OUT2
 plot VBE2 - VBE1
 plot VBE2 VBE1
 plot i(Vmeas)
 plot 20*log10((v(vdd)/v(out)))

 measure ac PSRR_10Hz  param=20*log10(mag(v(vdd)/v(out))) at=10
 measure ac PSRR_1k    param=20*log10(mag(v(vdd)/v(out))) at=1k
 measure ac PSRR_1Meg  param=20*log10(mag(v(vdd)/v(out))) at=1e6

.endc
"}
C {lab_pin.sym} 150 -500 0 0 {name=p3 sig_type=std_logic lab=VDD}
C {lab_pin.sym} 150 -120 0 0 {name=p4 sig_type=std_logic lab=VSS}
C {sky130_fd_pr/pfet_01v8.sym} 600 -470 0 0 {name=M3
W=20
L=5
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {res.sym} 620 -330 0 0 {name=R3
value=50k
footprint=1206
device=resistor
m=1}
C {sky130_fd_pr/nfet_01v8.sym} 770 -330 0 1 {name=M4
W=1
L=0.15
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 820 -230 0 0 {name=M5
W=1
L=0.15
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 860 -470 0 1 {name=M6
W=20
L=5
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 1000 -470 0 0 {name=M7
W=20
L=5
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 930 -390 0 0 {name=M8
W=5
L=5
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {lab_pin.sym} 240 -210 0 1 {name=p11 sig_type=std_logic lab=VBE1}
C {lab_pin.sym} 510 -610 0 1 {name=p12 sig_type=std_logic lab=OUT}
